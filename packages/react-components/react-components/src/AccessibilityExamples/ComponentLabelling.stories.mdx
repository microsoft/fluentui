import { Meta } from '@storybook/addon-docs';
import { FullscreenLink } from './utils';
import ReactDOM from 'react-dom';
export const parentPath = 'concepts-developer-accessibility-accessibilityexamples';
import {
  ActionAvoidBad,
  ActionAvoidGood,
  ComponentTypeAvoidBad,
  ComponentTypeAvoidGood,
  StateAvoidBad,
  StateAvoidGood,
  CustomPositionAvoidBad,
  CustomPositionAvoidGood,
  TextRepeatAvoidBad,
  TextRepeatAvoidGood,
  FocusTextAvoidBad,
  FocusTextAvoidGood,
  ReuseVisibleTextBad,
  ReuseVisibleTextGood,
} from './Examples.tsx';

import { Link } from '@fluentui/react-components';

<Meta title="Concepts/Developer/Accessibility/AccessibilityExamples/Component labelling" />

# Component labelling

The goal of accessibility examples is to identify and describe good and bad practice when designing accessible HTML interfaces following the ARIA specification.

## Component labelled reusing visible text

| Type of example | Code                                                                                                                                                                                                                                                                                                   | Screen reader narration                                                                                                          | Example                  |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Bad             | aria-label="Remove [user name]" attribute was applied on each button                                                                                                                                                                                                                                   | JAWS: "Remove Robert Tolbert Button To activate press spacebar. <br /> Remove Celeste Burton Button To activate press spacebar." | <ReuseVisibleTextBad />  |
| Good            | <ul><li>The id="user[number]" attribute was applied on the span element with user name.</li><li>The id="remove-button[number]" attribute was applied on the "Remove" button.</li><li>The aria-labelledby="remove-button[number] user[number]" attribute was applied on each "Remove" button.</li></ul> | JAWS: "Remove Robert Tolbert Button To activate press spacebar. <br />Remove Celeste Burton Button To activate press spacebar."  | <ReuseVisibleTextGood /> |

Problem explanation

<ul>
  <li>Even though the screen reader narration is the same for both examples, implementation is different.</li>
  <li>In general, for labelling we should reuse information that is visible/displayed in the UI.</li>
  <li>
    In this particular example, the aria-label attribute was added to the "Remove" button, and then, using the
    aria-labelledby attribute on the same button, we can refer to the "Remove" button itself.
  </li>
  <li>
    In many cases , using the aria-labelledby attribute avoids the translation of the element accessibility name to the
    desired UI language.
  </li>
  <li>
    {' '}
    The approach when a component refers to itself with the aria-labelledby attribute was taken from <Link
      href="https://www.w3.org/TR/accname-1.1/#terminology"
      inline
    >
      Accessible Name and Description Computation 1.1 page.
    </Link> To find the example on that page, go to "4.3.1 Terminology{'>'} 2B {'>'} Example"
  </li>
</ul>

## Avoid action in accessibility name

| Type of example | Code                                    | Screen reader narration                   | Example             |
| --------------- | --------------------------------------- | ----------------------------------------- | ------------------- |
| Bad             | aria-label="Click here to send message" | JAWS: "Click here to send message button" | <ActionAvoidBad />  |
| Good            | aria-label="Send message "              | JAWS: "Send message button"               | <ActionAvoidGood /> |

Problem explanation

<ul>
  <li>
    Adding the action instruction (such as "Click here to...") to the component accessible name prolongs the name
    narration by the screen reader when the component is focused. This information is already known to the screen reader
    user based on the type of component beeing used, i.e. a button in this case.
  </li>
  <li>
    Verify the component uses the proper HTML element or the proper ARIA role, so that the component type can be
    recognized by the screen reader.
  </li>
</ul>

## Avoid component type in accessibility name

| Type of example | Code                                | Screen reader narration               | Example                    |
| --------------- | ----------------------------------- | ------------------------------------- | -------------------------- |
| Bad             | aria-label="Mute microphone button" | JAWS: "Mute microphone button button" | <ComponentTypeAvoidBad />  |
| Good            | aria-label="Mute microphone"        | JAWS: "Mute microphone button"        | <ComponentTypeAvoidGood /> |

Problem explanation

<ul>
  <li>
    Adding the component type (such as "button") to the component accessible name duplicates information that is already
    automatically narrated by the screen reader when the component is focused.
  </li>
  <li>
    Verify the component uses the proper HTML element or the proper ARIA role, so that the component type can be
    recognized and automatically narrated by the screen reader.
  </li>
</ul>

## Avoid state in accessibility name

| Type of example | Code                                                                      | Screen reader narration                        | Example            |
| --------------- | ------------------------------------------------------------------------- | ---------------------------------------------- | ------------------ |
| Bad             | aria-label="Files tab is active" attribute was applied on the "Files" tab | JAWS:"Files tab is active tab selected 2 of 3" | <StateAvoidBad />  |
| Good            | no aria-label attribute is needed for the "Files" tab                     | JAWS: "Files tab selected 2 of 3"              | <StateAvoidGood /> |

Problem explanation

<ul>
  <li>
    Adding a custom hard-coded state to the accessible name of the component is not required, because this information
    will be provided by the screen reader if the component has the proper state attribute.
  </li>
  <li>
    If the state of component is not narrated by the screen reader, verify the proper ARIA state attribute is used, such
    as "aria-checked" or "aria-selected". See aria documentation for{' '}
    <Link href="https://www.w3.org/TR/wai-aria-1.1/#aria-selected" inline>
      aria-selected
    </Link>{' '}
    or{' '}
    <Link href="https://www.w3.org/TR/wai-aria-1.1/#aria-checked" inline>
      aria-checked
    </Link>{' '}
    attribute to find out which attribute should be used.
  </li>
</ul>

## Avoid position in accessibility name

| Type of example | Code                                                                                                                                                                                                                                           | Screen reader narration                                                                                                                                                                                                                    | Example                     |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------- |
| Bad             | A custom "X of Y" position information is hard-coded manually as the part of each menu item's "aria-label" attribute value.                                                                                                                    | JAWS: "Profile menu <br/> Account settings..., first item of four. To move through items press up or down arrow. <br/> Change status message..., second item of four <br /> Help, third item of four <br /> Sign out, fourth item of four" | <CustomPositionAvoidBad />  |
| Good            | The "X of Y" position information is added automatically by the screen reader for each menu item because the correct ARIA role is used both for all individual menu item elements (role="menuitem") and the parent menu element (role="menu"). | JAWS: "Profile menu <br /> Account settings..., 1 of 4. To move through items press up or down arrow. <br /> Change status message..., 2 of 4 <br /> Help, 3 of 4<br /> Sign out, 4 of 4"                                                  | <CustomPositionAvoidGood /> |

Problem explanation

<ul>
  <li>
    Even though the screen reader narration might seem similar, don't hard-code a custom "X of Y" position information
    manually as the part of the accessible name of each individual item, but instead use proper ARIA roles and let the
    screen reader add the "X of Y" information for you.
  </li>
  <li>
    The JAWS screen reader currently supports the "X of Y" information for the following roles: "listbox", "menu",
    "tablist" and "tree". See the <a href="https://www.w3.org/TR/wai-aria-1.2/">ARIA specification</a> to learn which
    required owned elements (such as "option", "menuitem", "tab" or "treeitem") should be used with these roles.
  </li>
</ul>

## Avoid repeating text for component inner items

ToDo: not label menu in bad example

| Type of example | Code                                                                                                                                                                       | Screen reader narration                                                                                                                                                                                               | Example                 |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------- |
| Bad             | aria-label="Meeting participant [user name]" attribute was applied on each menu item element.                                                                              | JAWS:"Participants menu <br /> Meeting participant Robert Tolbert 1 of 3 To move through items press up or down arrow. <br /> Meeting participant Celeste Burton 2 of 3 <br /> Meeting participant Cecil Folk 3 of 3" | <TextRepeatAvoidBad />  |
| Good            | <ul><li>no "aria-label" attribute is needed for each menu item element.</li><li>The aria-label="Meeting participants" attribute was applied on the menu element.</li></ul> | JAWS: "Meeting participants menu <br /> Robert Tolbert 1 of 3 To move through items press up or down arrow. <br /> Celeste Burton 2 of 3 <br /> Cecil Folk 3 of 3"                                                    | <TextRepeatAvoidGood /> |

Problem explanation

<ul>
  <li>
    Adding a repeating text as a part of the accessible name of each item in the component prolongs the name narration
    by the screen reader so the user needs to wait for the important content to be narrated.
  </li>
  <li> Recommendation would be to label the component (menu in our example) with appropriate name.</li>
  <li> This general principle is valid as well for other components like Tree, List, Listbox, Toolbar, etc.</li>
</ul>

## Avoid making text focusable

| Type of example | Code                                                                                                                                                                                                                                                                         | Screen reader narration                                                                                                                                                                                                                                                                  | Example                |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------- |
| Bad             | The text is made focusable by adding the tabindex="0" attribute on the text element. When the user uses the TAB key, the text receives focus.                                                                                                                                | JAWS narration when the notification text is focused: "With this option, notifications won’t be displayed anymore. You can miss information about latest news." <br />JAWS narration when the checkbox is focused: "Display notification check box not checked To check press Spacebar." | <FocusTextAvoidBad/>   |
| Good            | <ul> <li>The text is not focusable anymore, because the "tabindex" attribute does not exist on the text element.</li> <li>The text element has a unique id, like "notificationText".</li> <li>The checkbox has the aria-describedby="notificationText" attribute.</li> </ul> | "Display notification check box not checked <br />With this option, notifications won’t be displayed anymore. You can miss information about latest news.<br />To check press Spacebar"                                                                                                  | <FocusTextAvoidGood /> |

Problem explanation

<ul>
  <li>
    In general, elements (like text) that are not actionable should not receive focus, because it adds an additional TAB
    stop in the TAB order.
  </li>
  <li>
    {' '}
    Recommendation would be to refer to the text element via the "aria-describedby" attribute, which ensures the text
    would be read by the screen reader whenever the actionable element which has the "aria-describedby" attribute is
    focused.
  </li>
</ul>

## Using aria-label, aria-labelledby and aria-describedby examples

- <FullscreenLink content="Narrating error messages for form fields" parent={parentPath} story="form-error-messages" />
